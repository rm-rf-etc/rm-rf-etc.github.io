!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){!function(){function c(){this.controllers={},this.activeController=null}function d(a,b,c){this.parent=a||{},this.el=b||null,this.validates=!1,c&&("Object"===typeOf(c)?this.dom=c:"Function"===typeOf(c)&&c(this))}function e(a){if(!familyOf(this.el))throw new Error("Missing valid view element. Cannot build a DOM before doing `$.view = document.querySelector(<your_selector>)`.");if("Object"!==typeOf(a))throw new Error("Invalid dom structure object.");this.el||console.log("No element above current element");for(var b in a)a.hasOwnProperty(b)&&f.call(this,b,a)}function f(a,b){var c,e,f;if(i(a)){if(c=h(a),this.validates=c.validate,f=c.el,e=b[a],!e)return void this.el.appendChild(f);c.helpers&&c.helpers.length?g.call(this,c,f,e):"String"===typeOf(e)?f.innerHTML=e:builder=new d(this,f,e),this.el.appendChild(f),this.parent&&this.parent.validates&&"FORM"===this.el.tagName&&this.formValidate()}}function g(a,b,c){var e,f,g,h;a.helpers.map(function(a){var i,j;if("Function"!==typeOf(c))throw new Error('DOM object "'+key+'" defined with helper method but has no function upon which to apply it.');g=n.helpers[a.split("(")[0]],f=/\((.+)\)/g.exec(a)[1],e=f.split(".").reduce(function(a,b){return i=a,j=b,a[b]},n.models),e||console.info('Alert! Expected model "'+f+'" not available for each() templating helper'),h=new d(this,b),this.el.appendChild(b),g(h,i,j,c)}.bind(this))}function h(a){var b,c,d,e,f=null,g="",h="",i=[],j=!0,k=[],l=!1,m=[],n=["validate"];if(/^[^\w]/g.test(a))throw new Error("Descriptor doesn't begin with a tag name: "+a);if(b=/^([^\s]+)(?:\s(.*))?$/g.exec(a),c=b[1],c&&/#/g.test(c)&&c.match(/#/g).length>1)throw new Error("HTML descriptor cannot contain multiple ids: "+c);if(c=c.match(/[#.]?\w[\w\d-]*/g),g=c[0],c.map(function(a){switch(a[0]){case"#":h=a.slice(1);break;case".":i[i.length]=a.slice(1)}}),f=document.createElement(g),i.length&&(f.className=i.join(" ")),h&&(f.id=h),b[2]){if(d=b[2],e=d.match(s),/\w+\(.*\)$/g.test(d)&&/\w+\((?:[^\w].*|.*[^\w])\)$/g.test(d))throw new Error("Invalid helper definition: "+d);l=e.indexOf("validate")!==-1,e.map(function(a,b){switch(!0){case/^[\w\d][\w\d-]*$/.test(a):j=/^[\w\d][\w\d-]*$/.exec(a),n.indexOf(j[0])===-1&&(k[k.length]=[j[0],!0]);break;case/^(\w[\w\d-.]*)=["'](.*)["']$/.test(a):var c;j=/^([\w\d-.]+)=["']((?:\"|\'|[^'"])*)["']$/.exec(a),c=j[1].split("."),c[c.length]=j[2],k[k.length]=c;break;case/^\w[\w\d]+\([^)]+\)$/.test(a):m||(m=[]),m[m.length]=a;break;default:throw new Error("Invalid token in HTML descriptor: "+a)}}),k.forEach(function(a){a.reduce(function(b,c){return a.indexOf(c)!==a.length-2?b[c]:void(b[c]=a.pop())},f)})}return{el:f,validate:l,helpers:m}}function i(a){return!0}function j(a){for(var b=new DocumentFragment;a.firstChild;)b.appendChild(a.firstChild);return b}var k="undefined"!=typeof k?k:window;k.familyOf=a("typeof").familyOf,k.typeOf=a("typeof").typeOf;var l=a("connected"),m=l.Bindable,n=new c,o=Object.defineProperty,p=a("microevent"),q=new p,r=a("runway/runway-browser.js");Object.keys(r).map(function(a){n[a]=r[a]}),c.prototype.setView=function(a){var b=this;b.activeController!==a&&(b.activeController&&(b.activeController.builder.el=j(n.viewParent)),b.activeController=a,n.viewParent&&/^HTML.*Element/.test(typeOf(n.viewParent))&&n.viewParent.insertBefore(a.builder.el,n.viewParent.firstChild))},c.prototype.get=function(a,b){var c=k.XMLHttpRequest||ActiveXObject,d=new c("MSXML2.XMLHTTP.3.0");d.onload=function(){if(d.status>=200&&d.status<400)try{b(JSON.parse(d.responseText))}catch(a){console.log(a)}else console.log("failed")},d.open("GET",a,1),d.send()},c.prototype.inject=function(a){var b=document.createElement("script");b.src=a,document.body.appendChild(b)},c.prototype.Controller=a("./internal/concise.controller.js")(n,o,q,d),c.prototype.Model=a("./internal/concise.model.js")(n,m),c.prototype.models=new m({}),c.prototype.helpers=a("./internal/concise.helpers.js"),c.prototype.Region=function(a){this.area=document.createElement("div"),this.changeTo=function(b){var c=a[b];c&&"DomBuilder"===typeOf(c)&&(this.area.firstChild&&this.area.removeChild(this.area.firstChild),this.area.appendChild(c.el.cloneNode(!0)))},a.map(function(b,c){if("Object"!==typeOf(b))throw new Error("Region received invalid view object. Expected plain JS object.");a[c]=new d(null,null,b)})},o(d.prototype,"dom",{enumerable:!1,configurable:!1,set:e}),o(d.prototype,"model",{enumerable:!1,configurable:!1,set:function(){},get:function(){return this._model||this.parent.model}}),d.prototype.onFocus=function(a){this.el.addEventListener("focus",a)},d.prototype.onBlur=function(a){this.el.addEventListener("blur",a)},d.prototype.onSubmit=function(a){this.el.addEventListener("submit",a)},d.prototype.onClick=function(a){this.el.addEventListener("click",a)},d.prototype.onInput=function(a){this.el.addEventListener("input",a)},d.prototype.setValid=function(a,b){this.el.setCustomValidity(a?"":b)},d.prototype.formValidate=function(){console.log("FORM VALIDATE",this),this._model=new m({});var a=this._model,b=["input","textarea"];a._new_property_=["_valid_",!1];for(var c=this.el.firstChild;c;)b.indexOf(c.tagName.toLowerCase())!=-1&&c.name&&(a._new_property_=[c.name,""],m.bindField(c,a)),c=c.nextSibling};var s="";s+="(\\w+[\\w-]*(?:\\.\\w+)*=['].*?['])(?=\\s[\\w\\d.]+(?:[=(]|$))|",s+='(\\w+[\\w-]*(?:\\.\\w+)*=["].*?["])(?=\\s[\\w\\d.]+(?:[=(]|$))|',s+="(\\w+[\\w-]*(?:\\.\\w+)*=['].*?['])$|",s+='(\\w+[\\w-]*(?:\\.\\w+)*=["].*?["])$|',s+="(\\w+[\\w-]*[(]\\w(?:[\\w\\d]+|[\\w\\d.][^.])*[)])$|",s+="([\\w\\d-]+)",s=new RegExp(s,"g"),b.exports=k.concise=n}()},{"./internal/concise.controller.js":2,"./internal/concise.helpers.js":4,"./internal/concise.model.js":5,connected:7,microevent:6,"runway/runway-browser.js":10,typeof:12}],2:[function(a,b,c){b.exports=function(a,b,c,d){function e(b,e){var f=this;return console.info("new controller:",b,f),f._id=b||Math.random().toString().split(".")[1],f.builder=new d(null),f.builder.el=new DocumentFragment,e.call(f),a.controllers[b]=function(){c.trigger(f._id),a.setView(f)},a.controllers[b]}return e.prototype.onActive=function(a){c.bind(this._id,a)},b(e.prototype,"view",{enumerable:!1,configurable:!1,set:function(a){this.builder.dom="Function"===typeOf(a)?a(this):a}}),b(e.prototype,"models",{enumerable:!1,configurable:!1,get:function(){return a.models}}),e}},{}],3:[function(a,b,c){b.exports=function(a,b,c,d){function e(){Object.keys(b[c]).map(function(e){f.bind=function(a){return function(d){d.value=b[c][e][a],b[c][e].bind(a,function(a){d.value=a})}},"Function"===typeOf(d)?d.call(f,a,e,b[c][e]):"Object"===typeOf(d)&&(a.dom=d)})}var f=this;b.bind(c,function(b,c){for(;a.el.firstChild;)a.el.removeChild(a.el.firstChild);e()}),b[c]&&e()}},{}],4:[function(a,b,c){b.exports={each:a("./concise.helpers.each.js")}},{"./concise.helpers.each.js":3}],5:[function(a,b,c){b.exports=function(a,b){return function(c,d){if("Object"===typeOf(d)||"Array"===typeOf(d))return a.models._new_property_=[c,new b(d)],a.models[c]}}},{}],6:[function(a,b,c){var d=function(){};d.prototype={bind:function(a,b){this._events=this._events||{},this._events[a]=this._events[a]||[],this._events[a].push(b)},unbind:function(a,b){this._events=this._events||{},a in this._events!=!1&&this._events[a].splice(this._events[a].indexOf(b),1)},trigger:function(a){if(this._events=this._events||{},a in this._events!=!1)for(var b=0;b<this._events[a].length;b++)this._events[a][b].apply(this,Array.prototype.slice.call(arguments,1))}},d.mixin=function(a){for(var b=["bind","unbind","trigger"],c=0;c<b.length;c++)a.prototype[b[c]]=d.prototype[b[c]]},"undefined"!=typeof b&&"exports"in b&&(b.exports=d)},{}],7:[function(a,b,c){!function(){function c(a){return"Array"===r(a)?new e(a):"complex"===q(a)?new d(a):void 0}function d(a){Object.keys(a).map(function(b){this._new_property_=[b,a[b]]}.bind(this))}function e(a){var b,c=[];return t(c,"_timeout",{enumerable:!1,configurable:!1,value:60}),t(c,"bind",{enumerable:!1,configurable:!1,value:i}),t(c,"unbind",{enumerable:!1,configurable:!1,value:j}),t(c,"trigger",{enumerable:!1,configurable:!1,value:h}),t(c,"recompute",{enumerable:!1,configurable:!1,value:k}),t(c,"fieldManager",{enumerable:!1,configurable:!1,value:n}),t(c,"accept_id",{enumerable:!1,configurable:!1,value:function(a){a===v&&(b=a().id)}}),t(c,"_new_property_",{enumerable:!1,configurable:!1,set:function(a){g.call(c,a)}}),u(c,"push",function(a){c._new_property_=[c.length,a],y(c._timeout,"push"+b,function(){x.trigger(b,[c.length-1,c[c.length-1]],"push"),console.log("emit: push"+b)})}),u(c,"pop",function(){var a=c[c.length-1];return c.length=c.length-1,y(c._timeout,"pop"+b,function(){x.trigger(b,a,"pop"),console.log("emit: pop"+b)}),a}),u(c,"shift",function(){var a=c[0];return Object.keys(c).map(function(a){c[+a]=c[+a+1],c[+a]=v({fetch:function(b){c[+a]=v({id:b})}})}),c.length=c.length-1,y(c._timeout,"shift"+b,function(){x.trigger(b,a,"shift"),console.log("emit: shift"+b)}),a}),u(c,"unshift",function(a){return Object.keys(c).reverse().map(function(a){console.log(+a+1,+a),c._new_property_=[+a+1,c[+a]],c[+a]=v({fetch:function(b){c[+a+1]=v({id:b})}})}),c._new_property_=[0,a],y(c._timeout,"unshift"+b,function(){x.trigger(b,c,"unshift"),console.log("emit: unshift"+b)}),c.length}),u(c,"splice",function(){y(c._timeout,"splice"+b,function(){x.trigger(b,c,"splice"),console.log("emit: splice"+b)}),Array.prototype.splice.apply(c,arguments)}),u(c,"slice",function(){Array.prototype.slice.apply(c,arguments),y(c._timeout,"slice"+b,function(){x.trigger(b,c,"slice"),console.log("emit: slice"+b)})}),u(c,"reverse",function(a,d){for(var e=0;e<Math.floor(c.length/2);e++){var g=c.length-1-e;f.call(c,e,g)}return Array.prototype.reverse.call(c),y(c._timeout,"reverse"+b,function(){x.trigger(b,c,"reverse"),console.log("emit: reverse"+b)}),c}),u(c,"concat",function(a){return c.trigger(v({id:b})),"Array"===r(a)&&a.length&&Object.keys(a).map(function(b){c._new_property_=[c.length,a[b]]}),y(c._timeout,"concat"+b,function(){x.trigger(b,c,"concat"),console.log("emit: concat"+b)}),c}),Object.keys(a).map(function(b){c._new_property_=[+b,a[+b]]}),c}function f(a,b){this[b]=v({fetch:function(c){this[a]=v({fetch:function(d){this[b]=v({id:d}),this[a]=v({id:c})}})}})}function g(a){var b,d,e,f,g=this;return d=+Math.random().toString().split(".")[1],"Array"!==r(a)?(console.log("Abort! Bad property assignment:",a),void console.trace()):(e=a[0],f=a[1],g.trigger("_id","_new_property_:"+e),t(this,e,{enumerable:!0,configurable:!0,get:function(){return b},set:function(a){a===v&&v().fetch?v().fetch(d):a===v&&v().id?d=v().id:"complex"===q(a)?(b=new c(a),"Array"===r(a)&&b.accept_id(v({id:d})),x.trigger(d,b)):(b=a,x.trigger(d,b))}}),this[e]=f,void("Array"===r(f)&&this[e].accept_id(v({id:d}))))}function h(a){var b;a===v&&(b=v().id),a&&"_id"===a&&x.trigger(b)}function i(a,b){var c=this;c[a]=v({fetch:function(a){x.bind(a,b)}})}function j(a){x.unbind(a)}function k(a){return"complex"===q(a)&&this.constructor.apply(this,a),this}function l(a,b){[].forEach.call(a.querySelectorAll("input"),function(a){m(a,b)})}function m(a,b){if(a.name in b){var c=n();a.addEventListener("input",function(d){var e=function(){b[a.name]=d.target.value};c.input(e)}),b.bind(a.name,function(b){var d=function(){a.value=b};c.output(d)}),a.value=b[a.name]}}function n(){var a=!1;return{input:function(b){a=!0,b()},output:function(b){a?a=!1:b()}}}function o(a){var b=new c(a);return w.push(b),b}var p,q=a("typeof").familyOf,r=a("typeof").typeOf,s=a("microevent"),t=Object.defineProperty,u=function(a,b,c){t(a,b,{enumerable:!1,configurable:!1,value:c})},v=function(a){return a?(p=a,v):p},w=[],x=new s;t(d.prototype,"bind",{enumerable:!1,configurable:!1,value:i}),t(d.prototype,"unbind",{enumerable:!1,configurable:!1,value:j}),t(d.prototype,"trigger",{enumerable:!1,configurable:!1,value:h}),t(d.prototype,"recompute",{enumerable:!1,configurable:!1,value:k}),t(d.prototype,"fieldManager",{enumerable:!1,configurable:!1,value:n}),t(d.prototype,"onChange",{enumerable:!1,configurable:!1,value:function(a,b){var c=this;"Array"===r(a)&&a.forEach(function(a){c.bind(a,b)})}}),t(d.prototype,"_new_property_",{enumerable:!1,configurable:!1,set:function(a){g.call(this,a)}});var y;if(function(){var a={};y=function(b,c,d){clearTimeout(a[c]),a[c]=setTimeout(d,b)}}(),o.fieldManager=n,o.bindField=m,o.bindForm=l,o.unbind=j,o.bind=i,t(o,"bindables",{get:function(){return w},enumerable:!0}),t(o,"PROPERTY_MANIPULATOR",{value:v,writeable:!1}),"undefined"!=typeof b&&b.hasOwnProperty("exports")){var z={Bindable:o,familyOf:q,typeOf:r,unbind:j,bind:i};b.exports=z}else window.Connected=o,window.familyOf=q,window.typeOf=r}()},{microevent:8,typeof:12}],8:[function(a,b,c){arguments[4][6][0].apply(c,arguments)},{dup:6}],9:[function(a,b,c){arguments[4][6][0].apply(c,arguments)},{dup:6}],10:[function(a,b,c){function d(a,b){return console.log("processLink",a),a=a.replace(location.origin,""),"none"===b||(f(a),e(a),!1)}function e(a){h=i.go(a),h&&h()}function f(a){history.pushState?history.pushState({url:a},null,a):location.assign(a)}function g(){history.replaceState({url:location.pathname},null,location.pathname)}var h,i=a("./runway.js");i.bind("route added",function(){var a=i.go(location.pathname);a&&a!==h&&(h=a)()}),b.exports=i;var j=["A","BUTTON"];document.onclick=function(a){a=a||window.event;var b=a.target||a.srcElement;j.indexOf(b.tagName)!==-1&&b.href&&(a.preventDefault(),d(b.href,b.dataset.ajax))},window.onpopstate=function(a){e(a.state.url)},window.addEventListener?addEventListener("load",g,!1):window.attachEvent?attachEvent("onload",g):onload=g},{"./runway.js":11}],11:[function(a,b,c){function d(a){this.routes=e,this.go=g,this.listener=f}function e(a,b,c){var d,f,g;if("Array"===n(a)&&a.length&&!b)return void a.map(function(a){e.apply(null,a)});if("string"!=typeof a)throw new Error("Router accepts only a string as the first argument.");if(f=a,c=arguments[arguments.length-1],b=Array.isArray(b)?b:[],"Function"!==n(c))throw new Error("Controller either not specified or invalid.");return b.forEach(function(a){if("Function"!==n(a))throw new Error("Filter is not a function: "+{}.toString.apply(a))}),d=[].concat(b).concat(c),m&&"Function"===n(m)&&m("add route:",f,"filters and controller:",d),f=f.replace(/(^\/|\/$)/g,"").split("/"),f[f.length]="$",g=h(f,d),j(o,g),q.trigger("route added"),e}function f(a,b){var c=g(a.url);c&&c(a,b)}function g(a){function b(a,b){return a?a[b]||function(){var e=a["<regex>"]||void 0;if(e)for(var f=0;f<e.patterns.length;f++)if(e.patterns[f].test(b))return c[d++]=b,e[e.patterns[f].toString()]}():null}if(!o)throw new Error("No routes defined.");var c=[],d=0,e=a.slice(1).replace(/\/$/g,"").split("?")[0].split("/");e[e.length]="$";var f,g=e.reduce(b,o);return f=g&&g[0]?function(a,b){g[0](a,b,c)}:null}function h(a,b){return a.reverse().reduce(i,b)}function i(a,b){var c=Object.create(null);if(/^\{.+\}$/g.test(b)){if(!p[b])throw new Error("Unknown wildcard used in route: "+b);var d=new RegExp(p[b]);return c["<regex>"]={patterns:[d]},c["<regex>"][d.toString()]=a,c}return c[b]=a,c}function j(a,b,c){Object.keys(b).map(function(c){switch(!0){case"<regex>"===c:Object.hasOwnProperty.call(a,c)?b[c].patterns.map(function(b){k(a[c].patterns,b)&&a[c].patterns.push(b)}):a[c]=b[c];break;case Object.hasOwnProperty.call(a,c):j(a[c],b[c]);break;default:a[c]=b[c]}})}function k(a,b){return a.reduce(function(a,c){return a||l(c,b)},!1)}function l(a,b){return a.toString()===b.toString()}var m,n=a("typeof").typeOf,o=Object.create(null),p={"{int}":"([1-9][0-9]*)","{any}":"([^/]*)","{a-z}":"([a-zA-Z]+)","{num}":"([0-9]+)"};a("microevent").mixin(d);var q=b.exports=new d},{microevent:9,typeof:12}],12:[function(a,b,c){if("undefined"==typeof d)var d=function(){};b.exports=function(){function a(a){var c=b(a);return!!c&&({Date:"simple",String:"simple",Number:"simple",Boolean:"simple",Function:"simple",RegExp:"simple",Array:"complex",Object:"complex",HTMLElement:"complex",undefined:"falsey",null:"falsey",NaN:"falsey"}[c]||"complex")}function b(a){return"number"==typeof a?isNaN(a)?"NaN":"Number":a instanceof d?"HTMLElement":null!==a&&void 0!==a&&a.constructor?c(a):""+a}function c(a){var b;if(!a.constructor||!a.constructor.toString)throw new Error("Object constructor does not have toString method.");return b=a.constructor.toString(),/function\s+(\w+)/.test(b)?b.match(/function\s+(\w+)/)[1]:"Anonymous Class"}return{getObjectClass:c,familyOf:a,typeOf:b}}()},{}]},{},[1]);
